{% extends "base.html" %}
{% block content %}
<article class="card">
  <h2>Contact</h2>
  <form id="contactForm">
    <label>
      Name
      <input type="text" name="name" id="name" required />
    </label>
    <label>
      Email
      <input type="email" name="email" id="email" required />
    </label>
    <label>
      Message
      <textarea name="message" id="message" rows="6" required></textarea>
    </label>
    <button type="submit" class="btn">Send</button>
    <div id="status" style="margin-top:12px;"></div>
  </form>
</article>

<script>
document.getElementById("contactForm").addEventListener("submit", async function(e) {
  e.preventDefault();
  const status = document.getElementById("status");
  status.textContent = "Sending...";
  const payload = {
    name: document.getElementById("name").value,
    email: document.getElementById("email").value,
    message: document.getElementById("message").value
  };
  try {
    const res = await fetch("/api/contact", {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify(payload)
    });
    const j = await res.json();
    if (res.ok) {
      status.textContent = "Thanks â€” message received!";
      document.getElementById("contactForm").reset();
    } else {
      status.textContent = "Error: " + (j.detail || JSON.stringify(j));
    }
  } catch (err) {
    status.textContent = "Error sending message.";
    console.error(err);
  }
});
</script>
{% endblock %}
